아래의 조건을 모두 적용하여, 아래의 요구사항을 모두 구현할 것.
구현이 끝나면, 구현된 내용을 체크리스트 형태로 정리해서 반환할 것.

==============================================

조건-커서룰) 아래의 커서룰을 지키면서 작업할 것. 작업 완료 후, 이 rules를 잘 지켰는지 체크리스트로 정리할 것.
            - @01-common.mdc
            - @04-func.mdc

==============================================

조건-파일경로) HOOK 파일은 아래 경로에 만들 것: src/components/phone-new/hooks/index.address.hook.ts
조건-파일경로) TEST 파일은 아래 경로에 만들 것: src/components/phone-new/tests/index.address.hook.spec.ts
조건-파일경로) TYPES 파일은 아래 경로에 만들 것: src/components/phone-new/types/address.types.ts

==============================================

핵심요구사항) 아래 기능들을 Playwright 테스트를 사용해 TDD 방식(테스트 먼저 작성)으로 구현할 것.
             모든 테스트가 통과할 때까지 코드와 테스트를 계속 수정할 것.

1) 테스트에서 사용하지 말아야 할 라이브러리
   - jest
   - @testing-library/react

2) 테스트 조건
   - timeout은 아예 설정하지 않거나, 500ms보다 작게 설정할 것.
   - 페이지가 완전히 로드된 뒤에 테스트를 실행할 것.
       - 페이지 로드 완료 판단 방법: data-testid 같은 고정된 식별자를 기다리는 방식으로 할 것.
       - **중요금지사항** 페이지 로드 완료를 networkidle 같은 방식으로 기다리는 것은 금지.

3) 테스트 시나리오
   3-1) 주소 검색 성공 시나리오
        - 주소 검색 버튼을 클릭하면 → Daum 우편번호 팝업이 떠야 한다.
        - 팝업에서 주소를 선택하면 → 우편번호, 주소, 도로명 주소가 상태(state)에 저장되어야 한다.
        - 선택된 주소로 자동 지오코딩을 실행 → 위도/경도 값이 상태에 함께 저장되어야 한다.

   3-2) 좌표 수정 시 역지오코딩 시나리오
        - 사용자가 위도/경도 값을 직접 수정한다.
        - 수정된 좌표로 역지오코딩 API를 호출한다.
        - 역지오코딩 결과로 나온 주소가 상태에 다시 반영되어야 한다.

   3-3) 상태 공유 시나리오
        - 주소/좌표 값이 바뀌면, Zustand 스토어의 값도 바로 같이 바뀌어야 한다.
        - 지도 컴포넌트, 입력 폼, 제출 버튼이 모두 같은 상태 값을 참조할 수 있어야 한다.

==============================================

핵심요구사항) 주소 검색과 지오코딩(좌표 변환)을 한 번에 처리하는 통합 훅을 아래 순서대로 구현하고,
             구현이 끝나면 각 단계가 잘 되었는지 체크리스트로 정리할 것.

1. 주소 검색 기능 (Daum 우편번호 서비스)
   1-1) Daum 우편번호 서비스 스크립트 로드
        - 브라우저에서 script 태그를 동적으로 추가해서, 전역 객체인 daum.Postcode를 쓸 수 있게 만들 것.
        - 팝업 방식 또는 페이지 안에 임베드 방식 중에서 선택할 수 있도록 옵션을 둘 것.

   1-2) 주소 검색 팝업 열기 함수 구현
        - openAddressSearch() 함수를 만들어, 이 함수를 호출하면 Daum Postcode 팝업이 뜨도록 할 것.
        - 사용자가 팝업에서 주소를 선택하면, 콜백으로 선택된 주소 데이터를 넘겨줄 것.

   1-3) 주소 데이터 DTO 변환 및 표준화
        - Daum API가 넘겨주는 응답 데이터를 AddressData 타입으로 변환할 것.
        - 필드 매핑 규칙:
            - zonecode → zipCode (우편번호)
            - roadAddress → roadAddress (도로명 주소)
            - jibunAddress → jibunAddress (지번 주소)
            - address → address (기본 주소)
            - detailAddress → detailAddress (상세 주소, 사용자가 직접 입력하는 값)

2. 지오코딩 기능 (카카오 Maps API)
   2-1) 카카오 REST API 키 설정
        - 환경변수에서 KAKAO_REST_API_KEY 값을 불러올 것.
        - 카카오 API 호출 시 Authorization 헤더에 이 키를 넣어야 한다.

   2-2) 주소 → 좌표 변환 (지오코딩)
        - geocodeAddress(address: string) 함수를 구현할 것.
        - 카카오 주소 검색 API 호출:
          GET https://dapi.kakao.com/v2/local/search/address.json
        - 응답 데이터에서 x(경도), y(위도)를 꺼내올 것.
        - 변환 결과는 다음 형태로 반환:
          { latitude: number, longitude: number }

   2-3) 좌표 → 주소 변환 (역지오코딩)
        - reverseGeocode(latitude: number, longitude: number) 함수를 구현할 것.
        - 카카오 역지오코딩 API 호출:
          GET https://dapi.kakao.com/v2/local/geo/coord2address.json
        - 응답에서 address 객체를 추출할 것.
        - 이 address 정보를 AddressData 타입으로 변환해서 반환할 것.

3. 상태 관리 통합 (Zustand)
   3-1) Zustand 스토어 정의
        - 스토어 파일 경로: src/components/phone-new/stores/address.store.ts
        - 상태 구조는 다음과 같이 만들 것:
            - address: AddressData | null (현재 선택된 주소 정보)
            - coordinates: { latitude: number, longitude: number } | null (현재 좌표 정보)
            - isLoading: boolean (API 호출 중인지 여부)
            - error: string | null (에러 메시지)

   3-2) 액션 정의
        - setAddress(address: AddressData): 주소 상태를 설정한다.
        - setCoordinates(coords: { latitude: number, longitude: number }): 좌표 상태를 설정한다.
        - clearAddress(): 주소와 좌표를 모두 초기화한다.
        - setLoading(loading: boolean): 로딩 상태를 설정한다.
        - setError(error: string | null): 에러 메시지를 설정하거나 초기화한다.

4. 통합 훅 구현 (useAddressGeocoding)
   4-1) 훅이 반환해야 할 값
        - address: AddressData | null
        - coordinates: { latitude: number, longitude: number } | null
        - isLoading: boolean
        - error: string | null
        - openAddressSearch: () => void
          (주소 검색 팝업을 여는 함수)
        - updateCoordinates: (lat: number, lng: number) => Promise<void>
          (좌표를 수정하고, 역지오코딩을 실행하는 함수)
        - clearAll: () => void
          (주소와 좌표, 에러, 로딩 상태를 모두 초기화하는 함수)

   4-2) 주소 선택 후 자동 지오코딩 플로우
        - 사용자가 Daum 팝업에서 주소를 선택한다.
        - 선택된 데이터를 DTO 변환 후, Zustand 스토어의 address에 저장한다.
        - 그 다음 geocodeAddress()를 자동으로 호출한다.
        - 받아온 좌표를 Zustand 스토어의 coordinates에 저장한다.

   4-3) 좌표 수정 후 역지오코딩 플로우
        - updateCoordinates(lat, lng)를 호출한다.
        - 먼저 전달받은 좌표를 Zustand 스토어의 coordinates에 저장한다.
        - 그 다음 reverseGeocode()를 호출해서 역지오코딩을 수행한다.
        - 받아온 주소를 Zustand 스토어의 address에 업데이트한다.

5. 에러 처리
   5-1) API 호출 실패 시
        - API 호출 중 에러가 나면, 에러 메시지를 error 상태에 저장한다.
        - 예: "주소를 찾을 수 없습니다", "좌표 변환에 실패했습니다" 등 사용자가 이해하기 쉬운 메시지를 넣을 것.

   5-2) 네트워크 타임아웃
        - fetch 요청에 5초(timeout 5000ms) 제한을 둘 것.
        - 5초 안에 응답이 없으면 타임아웃 처리하고,
          "네트워크 연결을 확인해주세요" 같은 에러 메시지를 보여줄 것.

6. 타입 정의 (address.types.ts)
   6-1) AddressData 인터페이스
        ```typescript
        interface AddressData {
          zipCode: string;           // 우편번호
          roadAddress: string;       // 도로명 주소
          jibunAddress: string;      // 지번 주소
          address: string;           // 기본 주소
          detailAddress?: string;    // 상세 주소 (선택)
        }
        ```

   6-2) Coordinates 인터페이스
        ```typescript
        interface Coordinates {
          latitude: number;   // 위도
          longitude: number;  // 경도
        }
        ```

   6-3) AddressStore 인터페이스
        ```typescript
        interface AddressStore {
          address: AddressData | null;
          coordinates: Coordinates | null;
          isLoading: boolean;
          error: string | null;
          setAddress: (address: AddressData) => void;
          setCoordinates: (coords: Coordinates) => void;
          clearAddress: () => void;
          setLoading: (loading: boolean) => void;
          setError: (error: string | null) => void;
        }
        ```

==============================================

핵심요구사항) 다음의 통합 시나리오를 실제 동작으로 검증할 것.

1. 주소 검색 → 지오코딩 자동 실행
   - 주소를 선택하면, 바로 좌표가 계산되어 Zustand 스토어에 반영되어야 한다.
   - 지도 컴포넌트는 스토어를 구독해서, 좌표가 바뀔 때마다 마커 위치를 자동으로 업데이트해야 한다.

2. 좌표 수정 → 역지오코딩 자동 실행
   - 사용자가 위도/경도 입력 필드를 수정하면,
   - 역지오코딩을 통해 주소를 다시 계산해야 한다.
   - 계산된 주소로 입력 폼의 주소 필드가 자동으로 업데이트되어야 한다.

3. 다른 컴포넌트와 상태 공유
   - 지도 컴포넌트: coordinates를 구독해서 마커를 표시한다.
   - 입력 폼: address를 구독해서 폼 필드를 자동으로 채운다.
   - 제출 로직: address와 coordinates를 함께 묶어서 서버로 전송한다.
